rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Feature Flags Configuration
    match /config/features {
      // Anyone can read (frontend needs to know which demos are enabled)
      allow read: if true;
      
      // Write permissions:
      // 1. Allow creation if document doesn't exist (for initial setup)
      // 2. Only admins listed in admin_uids can update
      allow create: if request.auth != null;
      allow update: if request.auth != null 
                    && request.auth.uid in resource.data.admin_uids;
      allow delete: if request.auth != null 
                    && request.auth.uid in resource.data.admin_uids;
    }
    
    // Default deny all other paths
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
